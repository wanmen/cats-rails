<% content_for :head do %>
   <title><%= @book.title %> | 万门大学</title>
    <link rel="stylesheet" href="/assets/wm-pagedown.css" media="screen"/>
<% end %>
<main class="container" role="main">
  <article class="col-sm-8">
    <h3 class="page-header">
      <span class="wm-title"><%= @book.title %></span>
      <span class="wm-quick-link">
        <%= link_to '修改', edit_book_path(@book) %>  |
        <a href="JavaScript:window.history.back();">返回</a>
      </span>
    </h3>
    <section class="row wm-gallery">
      <figure class="col-sm-4">
        <img src="<%= @book.cover %>!medium" alt="" title="<%= @book.title %>">
      </figure>
      <div class="col-sm-8 wm-metadata">
        <span>作者</span> <%= @book.author %> <br/>
        <span>出版社</span> <%= @book.publisher %> <br/>
        <hr/>
        <%= render :partial => 'taglinks/taglinks' %>
        <%= render :partial => 'taglinks/form' %>
        <br/>
        <%= render :partial => 'links/links' %>
        <%= render :partial => 'links/form' %>
        <br/>
        <%= render :partial => 'rates/rates' %>
        <%= render :partial => 'rates/form' %>
        <br/>
        <%= render :partial => 'likes/likes' %>
        <%= render :partial => 'likes/form' %>
      </div>
    </section>

    <hr/>

    <section class="wm-indent">
     <%= @book.summary %>
    </section>

    <hr/>

    <section class="wm-book-comments">
      <div class="wm-sns-share">
        <span class="text-muted">分享到</span>
        <img src="/assets/sns/renren.png" height="24" alt="人人" title="分享到人人"/>
        <img src="/assets/sns/douban.png" height="24" alt="豆瓣" title="分享到豆瓣"/>
        <img src="/assets/sns/sina.png" height="24" alt="新浪微博" title="分享到新浪微博"/>
        <img src="/assets/sns/qzone.png" height="24" alt="QQ空间" title="分享到QQ空间"/>
        <img src="/assets/sns/tencent.png" height="24" alt="腾讯微博" title="分享到腾讯微博"/>
        <a class="btn btn-primary btn-sm wm-quick-link" href="">发表评论</a>
      </div>
    </section>

    <section class="wm-comments">
      <h4 class="text-muted">有2条评论</h4>
      <div class="row">
        <figure class="col-sm-2 wm-user-info">
          <a href="">
            <img class="img-rounded" src="/assets/user/user_soliton.jpg" alt="" title="soliton"/>
          </a>
        </figure>
        <div class="col-sm-10 wm-user-comment">
          <h5>
            <a href="">soliton</a>
            <span>2013-09-13 19:26</span>
          </h5>
          <p>如何理解人类的发展史？在挖掘冷冰冰的事实的时候，人们从制度转型的角度来试图解释为什么会这样。而政治、经济与社会则是理解制度转型最重要的三个方面。
          </p>
        </div>
      </div>
      <hr/>
      <div class="row">
        <figure class="col-sm-2 wm-user-info">
          <a href="">
            <img class="img-rounded" src="/assets/user/user_photino.jpg" alt="" title="photino"/>
          </a>
        </figure>
        <div class="col-sm-10 wm-user-comment">
          <h5>
            <a href="">photino</a>
            <span>2013-09-13 19:32</span>
          </h5>
          <p>作为后人，我们总是免不了要对发生过的历史作些“如果”的想象，特别是当这种历史对我们是带有屈辱色彩的历史。比如中国人就常想“如果戊戌变法成功了中国如何”，“没有文化大革命又如何”，同时也会有大量“为什么这样，为什么那样”的问题，如“为什么日本能维新成功，而中国不能”。
          </p>
        </div>
      </div>
    </section>

    <hr/>

    <section>
      <h4 class="text-muted">
        你的评论
        <a class="btn btn-primary btn-sm pull-right" href="../help/editor.html">如何编辑？</a>
      </h4>
      <form class="form-horizontal" role="form">
        <div class="wmd-panel">
          <div id="wmd-button-bar"></div>
          <textarea class="wmd-input" id="wmd-input"></textarea>
        </div>
        <div class="wmd-panel wmd-preview" id="wmd-preview"></div>
        <button class="btn btn-primary" type="submit">发布</button>
      </form>
    </section>
  </article>

  <aside class="col-sm-4">
    <section class="wm-recommend">
      <h3 class="page-header">
        <span class="glyphicon glyphicon-plus-sign"></span> 同主题推荐
        <a class="wm-quick-link" href="">查看全部</a>
      </h3>
      <div class="row">
        <figure class="col-sm-6">
          <a class="thumbnail" href="">
            <img src="http://img.wanmen.org/2013/09/5c4c8a8a674fa4be2f7374344f95a4aa.jpg" alt="" title="苏联遗传学劫难"/>
          </a>
          <figcaption>
            <a href="" title="苏联遗传学劫难">苏联遗传学劫难</a>
          </figcaption>
        </figure>
        <figure class="col-sm-6">
          <a class="thumbnail" href="">
            <img src="http://img.wanmen.org/2013/09/24dc33387b1c0ca121f5f7a8e4f8cfe4.jpg" alt="" title="人类基因的历史地图"/>
          </a>
          <figcaption>
            <a href="" title="人类基因的历史地图">人类基因的历史地图</a>
          </figcaption>
        </figure>
      </div>
      <div class="row">
        <figure class="col-sm-6">
          <a class="thumbnail" href="">
            <img src="http://img.wanmen.org/2013/09/adeb1e84045dbd4bcf398a71c887fa75.jpg" alt="" title="玻利维亚日记"/>
          </a>
          <figcaption>
            <a href="" title="玻利维亚日记">玻利维亚日记</a>
          </figcaption>
        </figure>
        <figure class="col-sm-6">
          <a class="thumbnail" href="">
            <img src="http://img.wanmen.org/2013/09/5537418d7e0b069154b597513189781b.jpg" alt=""/>
          </a>
          <figcaption>
            <a href="" title="学术与政治学术">学术与政治学术</a>
          </figcaption>
        </figure>
      </div>
    </section>
  </aside>
</main>

<script src="/assets/jquery.js"></script>
<script src="/assets/bootstrap.js"></script>
<script src="/assets/wm-dom.js"></script>
<script src="/assets/Markdown.Converter.js"></script>
<script src="/assets/Markdown.Sanitizer.js"></script>
<script src="/assets/Markdown.Editor.js"></script>
<script src="/assets/Markdown.Extra.js"></script>
<script src="/assets/Markdown.local.zh.js"></script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    showProcessingMessages: false,
    tex2jax: {inlineMath: [["$", "$"], ["\\(", "\\)"]]}
  });
</script>
<script type="text/javascript">
  (function() {
    var QUEUE = MathJax.Hub.queue,
      math = null;

    QUEUE.Push(function() {
      math = MathJax.Hub.getAllJax('#wmd-preview')[0];
    });

    window.UpdateMath = function(TeX) {
      $('wmd-preview').html(TeX);
      MathJax.Hub.Queue(['Typeset', math, 'wmd-preview']);
    }

    $('#wmd-input').keypress(function(event) {
      UpdateMath($(this).val());
    });

  })();
</script>
<script type="text/javascript">
  (function () {
    var converter = Markdown.getSanitizingConverter();
    converter.hooks.chain('preBlockGamut', function(text, rbg) {
      return text.replace(/^ {0,3}""" *\n((?:.*?\n)+?) {0,3}""" *$/gm,
        function (whole, inner) {
          return "<blockquote>" + rbg(inner) + '</blockquote>\n';
      });
    });

    var editor = new Markdown.Editor(converter, null, {strings: Markdown.local.zh});
    editor.run();
  })();
</script>
<div class="container">
  <div class="row">
    <div class="col-xs-8">
      <div class="page-header">
        <h3><%= @book.title %></h3>
        <p><a href="/scholars/<%=@book.user[:id]%>"><%= @book.user[:name] %></a>修改于<%= @book[:updated_at].strftime('%b %d, %Y %H:%M')  %>
          <%= link_to '修改', edit_book_path(@book) %>  |
          <%= link_to '返回', books_path %>
        </p>
      </div>
      <div class="row">
        <div class="col-xs-4">
          <a href="/books/<%= @book.id %>" class="thumbnail">
             <img src="<%= @book.cover %>!medium" width="360" height="248"  alt="">
          </a>
        </div>
        <div class="col-xs-8">
          作者: <%= @book.author %><br/>
          链接：<%= @book.url %><br/>
          出版社: <%= @book.publisher %><br/>
          ISBN：<%= @book.isbn %><br/>
          豆瓣ID：<%= @book.dbid %><br/>
          <hr/>
          书单
          <%= render :partial => 'links/links' %>
          <%= render :partial => 'links/form' %>
          <br/>
          标签
          <%= render :partial => 'taglinks/taglinks' %>
          <%= render :partial => 'taglinks/form' %>
          <br/>
          喜欢
          <%= render :partial => 'likes/likes' %>
          <%= render :partial => 'likes/form' %>
          <br/>
          推荐指数
          <%= render :partial => 'rates/rates' %>
          <%= render :partial => 'rates/form' %>
        </div>
      </div>
    </div>
  </div>
  <div class="col-xs-8">
     <%= @book.summary %>
  </div>
  <div class="col-xs-8">

  <%= render :partial => 'comments/comments' %>
  <%= render :partial => 'comments/form' %>
  </div>
</div>
</div>
